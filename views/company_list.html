{% extends 'layout.html' %}

{% block css %}
<link href="../assets/plugins/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-autofill-bs4/css/autoFill.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-colreorder-bs4/css/colReorder.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-keytable-bs4/css/keyTable.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-rowreorder-bs4/css/rowReorder.bootstrap4.min.css" rel="stylesheet" />
<link href="../assets/plugins/datatables.net-select-bs4/css/select.bootstrap4.min.css" rel="stylesheet" />
{% endblock %}

{% block content %}
<!-- begin #content -->
<div id="content" class="content">
	<!-- begin page-header -->
	<h1 class="page-header">사업자 목록</h1>
	<!-- end page-header -->
	<!-- begin panel -->
	<div class="panel panel-inverse">
		<!-- begin panel-heading -->
		<div class="panel-heading">
			<h4 class="panel-title">업체</h4>
		</div>
		<!-- end panel-heading -->
		<!-- begin panel-body -->
		<div class="panel-body">
			<table id="data-table-default" class="table table-striped table-bordered table-td-valign-middle">

					
					{% if devices %}
					<center>
			            <div class="btn-group m-b-5 mx-3">
			               <a href="/company_list" class="btn btn-primary text-white px-4">Back</a>
			            </div>
			        </center>
						<thead>
							<tr>
								<th width="1%">
									<input type="checkbox" class="neHeros" value="" onChange="allCheckedBox(this);"/>
								</th>
								<th>모델명</th>
								<th>버전</th>
								<th>맥 주소</th>
								<th>별칭</th>
								<th width="1%"></th>
							</tr>
						</thead>
						<tbody>					
					
						{% for device in devices %}
						<tr>
							<td class="with-btn" nowrap>
								<input id ="ck" type="checkbox" name = "ck" class="neHeros" value={{device.MAC}} onChange="eachCheckedBox(this);"/>
							</td>
							<td>{{device.MD}}</td>
							<td>{{device.VER}}</td>
							<td>{{device.MAC}}</td>
							<td>{{device.NN}}</td>
							<td class="with-btn" nowrap>
								<a href="/device_edit/{{device.MAC}}" class="btn btn-sm btn-primary width-60 m-r-2 edit-btn">수정</a>
								<a href="javascript:delete_check('{{device.MAC}}')" class="btn btn-sm btn-white width-60">삭제</a>
							</td>
						</tr>
						{% endfor %}
						
					{% elif cars %}
					
					<center>
			            <div class="btn-group m-b-5 mx-3">
			               <a href="/company_list" class="btn btn-primary text-white px-4">Back</a>
			            </div>
			        </center>
							<thead>
								<tr>
									<th width="1%">
										<input type="checkbox" class="neHeros" value="" onChange="allCheckedBox(this);"/>
									</th>
									<th>차종</th>
									<th>차량 번호</th>
									<th>차대 번호</th>
									<th width="1%"></th>
								</tr>
							</thead>
							<tbody>					
						{% for car in cars %}
							<tr>
    							<td class="with-btn" nowrap>
									<input id ="ck" type="checkbox" name = "ck" class="neHeros" value={{car.CN}} onChange="eachCheckedBox(this);"/>
    							</td>
								<td>{{car.CC}}</td>
								<td>{{car.CN}}</td>
								<td>{{car.SN}}</td>
								<td class="with-btn" nowrap>
									<a href="/car_edit/{{car.CN}}" class="btn btn-sm btn-primary width-60 m-r-2">수정</a>
									<a href="javascript:delete_check('{{car.CN}}')" class="btn btn-sm btn-white width-60">삭제</a>
								</td>
							</tr>
							{% endfor %}
					
					{% elif workers %}
					
					<center>
			            <div class="btn-group m-b-5 mx-3">
			               <a href="/company_list" class="btn btn-primary text-white px-4">Back</a>
			            </div>
			        </center>					
        					<thead>
        						<tr>
        							<th width="1%"><input type="checkbox" class="neHeros" value="" onChange="allCheckedBox(this);"/></th>
        							<th width="1%" data-orderable="false"></th>
        							<th>이름</th>
        							<th>전화번호</th>
        							<th>이메일</th>
        							<th width="1%">승인</th>
        							<th width="1%"></th>
        						</tr>
        					</thead>
        					<tbody>					
						{% for worker in workers %}
    						<tr>
    							<td class="with-btn" nowrap>
									<input id ="ck" type="checkbox" name = "AC" class="neHeros" value={{worker.EM}} {% if worker.AC == true %} checked {% else %} unchecked  {% endif %} onChange="eachCheckedBox(this);"/>
    							</td>
                                <td width="1%" class="with-img"><img src={{worker.PU}} class="img-rounded height-30" /></td>
    							<td>{{worker.WN}}</td>
    							<td>{{worker.PN}}</td>
    							<td>{{worker.EM}}</td>
    							    <input type="hidden" name="EM" value="{{worker.EM}}">
    							<td class="with-btn" nowrap>
    								<a href="/worker_list/?workeracem={{worker.AC}},{{worker.EM}}" class="btn btn-sm width-60 m-r-2 edit-btn">
        								<input id ="ckone" type="checkbox" data-render="switchery" data-theme="default" name="ckone"  {% if worker.AC == true %} checked {% else %} unchecked  {% endif %} />
    								</a>
    							</td>
    							<td>
    								<a class="btn btn-sm btn-white width-60" href="javascript:delete_check('{{worker.EM}}')">삭제</a>
    								<!--<a class="btn btn-sm btn-white width-60" onclick ="confirm({{worker.EM}})">Delete</a>-->
    							</td>
    						</tr>
    						{% endfor %}
    						
    				{% elif historys %}
					<center>
			            <div class="btn-group m-b-5 mx-3">
			               <a href="/company_list" class="btn btn-primary text-white px-4">Back</a>
			            </div>
			        </center>    				
						<thead>
							<tr>
								<th width="1%">
									<input type="checkbox" class="neHeros" value="" onChange="allCheckedBox(this);"/>
								</th>
								<th class="text-nowrap">차량 번호</th>
							    <th class="text-nowrap">소독 일시</th>
								<th class="text-nowrap">등록 일시</th>
								<th class="text-nowrap">소독 시간</th>
								<th class="text-nowrap">소독 결과</th>
								<th width="1%"></th>
							</tr>
						</thead>
						<tbody>    						
    					{% for history in historys %}
						<tr onClick="location.href='/history_chart/{{history._id}}'" class="odd gradeX">
	  						<td onclick='event.cancelBubble=true;' class="with-btn" nowrap>
	 							<input id="ck" type="checkbox" name = "_id" class="neHeros" value={{history._id}} onChange="eachCheckedBox(this);"/>
	  						</td>
							<td>
								{% for car in cars %}
									{% if (car._id == history.VID) %}
										{{car.CN}}
									{% endif %}
								{% endfor %}
							</td>
							<td>{{moment(history.ET).format('YYYY-MM-DD hh:mm:ss')}}</td>
							<td>{{moment(history.CA).format('YYYY-MM-DD hh:mm:ss')}}</td>
							<td>{{moment(history.ET).diff(moment(history.ST), 'minutes')+"m"}}</td>
							<td>{{history.RC}}</td>
	  						<td>
	  							<a href="javascript:delete_check('{{history._id}}')" class="btn btn-sm btn-white width-60">삭제</a>
	  						</td>
						</tr>
						{% endfor %}
					
					{% else %}				
						<thead>
							<tr>
								<th class="text-nowrap">상호명</th>
							    <th class="text-nowrap">사업자 번호</th>
								<th class="text-nowrap">대표자</th>
								<th class="text-nowrap">회사 전화번호</th>
								<th class="text-nowrap">휴대폰 번호</th>
								<th class="text-nowrap">대표 이메일</th>
								<th class="text-nowrap">가입 일자</th>
								<th width="1%" class="text-nowrap">장비/차량/작업자/소독이력</th>
							</tr>
						</thead>
						<tbody>
							
						{% for company in companys %}
						<tr class="odd gradeX">
							<td>{{company.CNA}}</td>
							<td>{{company.CNU}}</td>
							<td>{{company.NA}}</td>
							<td>{{company.PN}}</td>
							<td>{{company.MN}}</td>
							<td>{{company.EA}}</td>
							<td>{{moment(company.CA).format('YYYY-MM-DD hh:mm:ss')}}</td>
							<td class="d-flex flex-nowrap justify-content-around">
								<a href="/company_list/?DEVICE={{company._id}}"><button type="button" class="btn btn-primary px-2"><i class="fas fa-lg fa-fw fa-microchip"></i></button></a>
								<a href="/company_list/?CAR={{company._id}}"><button type="button" onClick="location.href='/company_device/{{company._id}}" class="btn btn-info px-2"><i class="fas fa-lg fa-fw fa-car"></i></button></a>
								<a href="/company_list/?WORKER={{company._id}}"><button type="button" onClick="location.href='/company_device/{{company._id}}" class="btn btn-warning px-2"><i class="fas fa-lg fa-fw fa-user"></i></button></a>
								<a href="/company_list/?HISTORY={{company._id}}"><button type="button" onClick="location.href='/company_device/{{company._id}}" class="btn btn-danger px-2"><i class="fas fa-lg fa-fw fa-history"></i></button></a>
							</td>
						</tr>
						{% endfor %}
					
					{% endif %}
						

				</tbody>
			</table>
		</div>
		<!-- end panel-body -->
	</div>
	<!-- end panel -->
</div>
<!-- end #content -->
{% endblock %}

{% block script %}
<script src="../assets/plugins/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../assets/plugins/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="../assets/plugins/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="../assets/plugins/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>
<script src="../assets/js/demo/table-manage-default.demo.js"></script>
{% endblock %}